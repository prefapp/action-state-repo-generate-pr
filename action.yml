name: 'Update image and create a pull request'
description: >
  Using state repo structure it updates an image value and the creates 
  a pull request in the same state repo
inputs:
  input_matrix:
    description: >
      Inputs in the format:
        [ 
          {
            tenant: 'tenant1',
            app: 'release_foo',
            env: 'pre',
            service_names: [ 'hello' ],
            image: 'test-service:last_prerelease_default',
            reviewers: [ 'test@prefapp.es' ]  // this parameter (and only) is optional
          }
        ]
    required: true
  branch_name:
    description: 'Name of the new branch used to pull request'
    required: false
    default: ''
  token:
    description: >
      Personal access token (PAT) used to fetch the repository. The PAT is configured
      with the local git config, which enables your scripts to run authenticated git
      commands. The post-job step removes the PAT.
      We recommend using a service account with the least permissions necessary.
      Also when generating a new PAT, select the least scopes necessary.
      [Learn more about creating and using encrypted secrets](https://help.github.com/en/actions/automating-your-workflow-with-github-actions/creating-and-using-encrypted-secrets)
    default: ${{ github.token }}

runs:
  using: 'node12'
  main: 'dist/index.js'
